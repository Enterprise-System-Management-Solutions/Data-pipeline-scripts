--
-- P_L1_FROM_L1_RECURRING_TEMP  (Procedure) 
--
CREATE OR REPLACE PROCEDURE DWH_USER.P_L1_FROM_L1_RECURRING_TEMP (P_PROCESS_DATE VARCHAR2) IS
    VCOUNT NUMBER;
    VDATE_KEY NUMBER;
    VSTATUS NUMBER;
    VDATE DATE := TO_DATE(TO_DATE(P_PROCESS_DATE,'YYYYMMDD'),'DD/MM/RRRR');
BEGIN

    SELECT DATE_KEY INTO VDATE_KEY FROM DATE_DIM
    WHERE DATE_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = VDATE);

        
    SELECT COUNT(STATUS) INTO VSTATUS
    FROM ETL_LOG
    WHERE DATE_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = VDATE)
    AND LAYER = 'L2_RECURRING_TEMP_FULL'
    AND SOURCE = 'mon';   
    
    IF VSTATUS = 0 THEN
        INSERT INTO ETL_LOG (LAYER, DATE_KEY, SOURCE, STATUS, FILE_COUNT, PER_COUNT, POST_COUNT, INSERT_TIME)
        VALUES              ('L2_RECURRING_TEMP_FULL',VDATE_KEY,'mon','30',VCOUNT,'','',SYSDATE);
        COMMIT;
        INSERT INTO L1_RECURRING(PROCESSED_DATE, FILE_NAME, R1_CDR_ID, R2_CDR_SUB_ID, R3_CDR_TYPE, R4_SPLIT_CDR_REASON, R5_CDR_BATCH_ID, R6_SRC_REC_LINE_NO, R7_SRC_CDR_ID, R8_SRC_CDR_NO, R9_STATUS, R10_RE_RATING_TIMES, R11_CREATE_DATE, R12_START_DATE, R13_END_DATE, R14_CUST_LOCAL_START_DATE, R15_CUST_LOCAL_END_DATE, R16_STD_EVT_TYPE_ID, R17_EVT_SOURCE_CATEGORY, R18_OBJ_TYPE, R19_OBJ_ID, R20_OWNER_CUST_ID, R21_DEFAULT_ACCT_ID, R22_PRI_IDENTITY, R23_BILL_CYCLE_ID, R24_SERVICE_CATEGORY, R25_USAGE_SERVICE_TYPE, R26_SESSION_ID, R27_RESULT_CODE, R28_RESULT_REASON, R29_BE_ID, R30_HOT_SEQ, R31_CP_ID, R32_RECIPIENT_NUMBER, R33_USAGE_MEASURE_ID, R34_ACTUAL_USAGE, R35_RATE_USAGE, R36_SERVICE_UNIT_TYPE, R37_USAGE_MEASURE_ID2, R38_ACTUAL_USAGE2, R39_RATE_USAGE2, R40_SERVICE_UNIT_TYPE2, R41_DEBIT_AMOUNT, R42_RESERVED, R43_DEBIT_FROM_PREPAID, R44_DEBIT_FROM_ADVANCE_PREPAID, R45_DEBIT_FROM_POSTPAID, R46_DEBIT_FROM_ADVNCE_POSTPAID, R47_DEBIT_FROM_CREDIT_POSTPAID, 
        R48_TOTAL_TAX, R49_FREE_UNIT_AMOUNT_OF_TIMES, R50_FREE_UNIT_AMT_OF_DURATION, R51_FREE_UNIT_AMOUNT_OF_FLUX, R52_ACCT_ID, R53_ACCT_BALANCE_ID, R54_BALANCE_TYPE, R55_CUR_BALANCE, R56_CHG_BALANCE, R57_CURRENCY_ID, R58_OPER_TYPE, R59_ACCT_ID, R60_ACCT_BALANCE_ID, R61_BALANCE_TYPE, R62_CUR_BALANCE, R63_CHG_BALANCE, R64_CURRENCY_ID, R65_OPER_TYPE, R66_ACCT_ID, R67_ACCT_BALANCE_ID, R68_BALANCE_TYPE, R69_CUR_BALANCE, R70_CHG_BALANCE, R71_CURRENCY_ID, R72_OPER_TYPE, R73_ACCT_ID, R74_ACCT_BALANCE_ID, R75_BALANCE_TYPE, R76_CUR_BALANCE, R77_CHG_BALANCE, R78_CURRENCY_ID, R79_OPER_TYPE, R80_ACCT_ID, R81_ACCT_BALANCE_ID, R82_BALANCE_TYPE, R83_CUR_BALANCE, R84_CHG_BALANCE, R85_CURRENCY_ID, R86_OPER_TYPE, R87_ACCT_ID, R88_ACCT_BALANCE_ID, R89_BALANCE_TYPE, R90_CUR_BALANCE, R91_CHG_BALANCE, R92_CURRENCY_ID, R93_OPER_TYPE, R94_ACCT_ID, R95_ACCT_BALANCE_ID, R96_BALANCE_TYPE, R97_CUR_BALANCE, R98_CHG_BALANCE, R99_CURRENCY_ID, R100_OPER_TYPE, R101_ACCT_ID, 
        R102_ACCT_BALANCE_ID, R103_BALANCE_TYPE, R104_CUR_BALANCE, R105_CHG_BALANCE, R106_CURRENCY_ID, R107_OPER_TYPE, R108_ACCT_ID, R109_ACCT_BALANCE_ID, R110_BALANCE_TYPE, R111_CUR_BALANCE, R112_CHG_BALANCE, R113_CURRENCY_ID, R114_OPER_TYPE, R115_ACCT_ID, R116_ACCT_BALANCE_ID, R117_BALANCE_TYPE, R118_CUR_BALANCE, R119_CHG_BALANCE, R120_CURRENCY_ID, R121_OPER_TYPE, R122_FU_OWN_TYPE, R123_FU_OWN_ID, R124_FREE_UNIT_ID, R125_FREE_UNIT_TYPE, R126_CUR_AMOUNT, R127_CHG_AMOUNT, R128_FU_MEASURE_ID, R129_OPER_TYPE, R130_FU_OWN_TYPE, R131_FU_OWN_ID, R132_FREE_UNIT_ID, R133_FREE_UNIT_TYPE, R134_CUR_AMOUNT, R135_CHG_AMOUNT, R136_FU_MEASURE_ID, R137_OPER_TYPE, R138_FU_OWN_TYPE, R139_FU_OWN_ID, R140_FREE_UNIT_ID, R141_FREE_UNIT_TYPE, R142_CUR_AMOUNT, R143_CHG_AMOUNT, R144_FU_MEASURE_ID, R145_OPER_TYPE, R146_FU_OWN_TYPE, R147_FU_OWN_ID, R148_FREE_UNIT_ID, R149_FREE_UNIT_TYPE, R150_CUR_AMOUNT, R151_CHG_AMOUNT, R152_FU_MEASURE_ID, R153_OPER_TYPE, R154_FU_OWN_TYPE, R155_FU_OWN_ID, R156_FREE_UNIT_ID, R157_FREE_UNIT_TYPE, R158_CUR_AMOUNT, R159_CHG_AMOUNT, R160_FU_MEASURE_ID, R161_OPER_TYPE, R162_FU_OWN_TYPE, R163_FU_OWN_ID, R164_FREE_UNIT_ID, R165_FREE_UNIT_TYPE, R166_CUR_AMOUNT, 
        R167_CHG_AMOUNT, R168_FU_MEASURE_ID, R169_OPER_TYPE, R170_FU_OWN_TYPE, R171_FU_OWN_ID, R172_FREE_UNIT_ID, R173_FREE_UNIT_TYPE, R174_CUR_AMOUNT, R175_CHG_AMOUNT, R176_FU_MEASURE_ID, R177_OPER_TYPE, R178_FU_OWN_TYPE, R179_FU_OWN_ID, R180_FREE_UNIT_ID, R181_FREE_UNIT_TYPE, R182_CUR_AMOUNT, R183_CHG_AMOUNT, R184_FU_MEASURE_ID, R185_OPER_TYPE, R186_FU_OWN_TYPE, R187_FU_OWN_ID, R188_FREE_UNIT_ID, R189_FREE_UNIT_TYPE, R190_CUR_AMOUNT, R191_CHG_AMOUNT, R192_FU_MEASURE_ID, R193_OPER_TYPE, R194_FU_OWN_TYPE, R195_FU_OWN_ID, R196_FREE_UNIT_ID, R197_FREE_UNIT_TYPE, R198_CUR_AMOUNT, R199_CHG_AMOUNT, R200_FU_MEASURE_ID, R201_OPER_TYPE, R202_ACCT_ID, R203_ACCT_BALANCE_ID, R204_BALANCE_TYPE, R205_BONUS_AMOUNT, R206_CUR_BALANCE, R207_CURRENCY_ID, R208_OPER_TYPE, R209_CUR_EXPIRE_TIME, R210_ACCT_ID, R211_ACCT_BALANCE_ID, R212_BALANCE_TYPE, R213_CUR_BALANCE, R214_CHG_BALANCE, R215_CURRENCY_ID, R216_OPER_TYPE, R217_CUR_EXPIRE_TIME, R218_ACCT_ID, R219_ACCT_BALANCE_ID, R220_BALANCE_TYPE, R221_CUR_BALANCE, R222_CHG_BALANCE, R223_CURRENCY_ID, R224_OPER_TYPE, R225_CUR_EXPIRE_TIME, R226_ACCT_ID, R227_ACCT_BALANCE_ID, R228_BALANCE_TYPE, R229_BONUS_AMOUNT, R230_CUR_BALANCE, R231_CURRENCY_ID, R232_OPER_TYPE, R233_CUR_EXPIRE_TIME, R234_ACCT_ID, R235_ACCT_BALANCE_ID, 
        R236_BALANCE_TYPE, R237_BONUS_AMOUNT, R238_CUR_BALANCE, R239_CURRENCY_ID, R240_OPER_TYPE, R241_CUR_EXPIRE_TIME, R242_ACCT_ID, R243_ACCT_BALANCE_ID, R244_BALANCE_TYPE, R245_BONUS_AMOUNT, R246_CUR_BALANCE, R247_CURRENCY_ID, R248_OPER_TYPE, R249_CUR_EXPIRE_TIME, R250_ACCT_ID, R251_ACCT_BALANCE_ID, R252_BALANCE_TYPE, R253_BONUS_AMOUNT, R254_CUR_BALANCE, R255_CURRENCY_ID, R256_OPER_TYPE, R257_CUR_EXPIRE_TIME, R258_ACCT_ID, R259_ACCT_BALANCE_ID, R260_BALANCE_TYPE, R261_BONUS_AMOUNT, R262_CUR_BALANCE, R263_CURRENCY_ID, R264_OPER_TYPE, R265_CUR_EXPIRE_TIME, R266_ACCT_ID, R267_ACCT_BALANCE_ID, R268_BALANCE_TYPE, R269_BONUS_AMOUNT, R270_CUR_BALANCE, R271_CURRENCY_ID, R272_OPER_TYPE, R273_CUR_EXPIRE_TIME, R274_ACCT_ID, R275_ACCT_BALANCE_ID, R276_BALANCE_TYPE, R277_BONUS_AMOUNT, R278_CUR_BALANCE, R279_CURRENCY_ID, R280_OPER_TYPE, R281_CUR_EXPIRE_TIME, R282_FU_OWN_TYPE, R283_FU_OWN_ID, R284_FREE_UNIT_TYPE, R285_FREE_UNIT_ID, R286_BONUS_AMOUNT, R287_CURRENT_AMOUNT, R288_FU_MEASURE_ID, R289_OPER_TYPE, R290_CUR_EXPIRE_TIME, R291_FU_OWN_TYPE, R292_FU_OWN_ID, R293_FREE_UNIT_TYPE, R294_FREE_UNIT_ID, R295_BONUS_AMOUNT, R296_CURRENT_AMOUNT, R297_FU_MEASURE_ID, R298_OPER_TYPE, R299_CUR_EXPIRE_TIME, R300_FU_OWN_TYPE, R301_FU_OWN_ID, 
        R302_FREE_UNIT_TYPE, R303_FREE_UNIT_ID, R304_BONUS_AMOUNT, R305_CURRENT_AMOUNT, R306_FU_MEASURE_ID, R307_OPER_TYPE, R308_CUR_EXPIRE_TIME, R309_FU_OWN_TYPE, R310_FU_OWN_ID, R311_FREE_UNIT_TYPE, R312_FREE_UNIT_ID, R313_BONUS_AMOUNT, R314_CURRENT_AMOUNT, R315_FU_MEASURE_ID, R316_OPER_TYPE, R317_CURRENT_AMOUNT, R318_FU_OWN_TYPE, R319_FU_OWN_ID, R320_FREE_UNIT_TYPE, R321_FREE_UNIT_ID, R322_BONUS_AMOUNT, R323_CURRENT_AMOUNT, R324_FU_MEASURE_ID, R325_OPER_TYPE, R326_CUR_EXPIRE_TIME, R327_FU_OWN_TYPE, R328_FU_OWN_ID, R329_FREE_UNIT_TYPE, R330_FREE_UNIT_ID, R331_BONUS_AMOUNT, R332_CURRENT_AMOUNT, R333_FU_MEASURE_ID, R334_OPER_TYPE, R335_CUR_EXPIRE_TIME, R336_FU_OWN_TYPE, R337_FU_OWN_ID, R338_FREE_UNIT_TYPE, R339_FREE_UNIT_ID, R340_BONUS_AMOUNT, R341_CURRENT_AMOUNT, R342_FU_MEASURE_ID, R343_OPER_TYPE, R344_CUR_EXPIRE_TIME, R345_FU_OWN_TYPE, R346_FU_OWN_ID, R347_FREE_UNIT_TYPE, R348_FREE_UNIT_ID, R349_BONUS_AMOUNT, R350_CURRENT_AMOUNT, R351_FU_MEASURE_ID, R352_OPER_TYPE, R353_CUR_EXPIRE_TIME, R354_FU_OWN_TYPE, R355_FU_OWN_ID, R356_FREE_UNIT_TYPE, R357_FREE_UNIT_ID, R358_BONUS_AMOUNT, R359_CURRENT_AMOUNT, R360_FU_MEASURE_ID, R361_OPER_TYPE, R362_CUR_EXPIRE_TIME, R363_FU_OWN_TYPE, R364_FU_OWN_ID, R365_FREE_UNIT_TYPE,
        R366_FREE_UNIT_ID, R367_BONUS_AMOUNT, R368_CURRENT_AMOUNT, R369_FU_MEASURE_ID, R370_OPER_TYPE, R371_CUR_EXPIRE_TIME, R372_BRANDID, R373_MAINOFFERINGID, R374_PAYTYPE, R375_CHARGINGPARTYNUMBER, R376_CHARGINGPARTYTYPE, R377_CYCLEBEGINTIME,
        R378_CYCLEENDTIME, R379_CYCLETYPE, R380_CYCLELENGTH, R381_ELAPSECYCLES, R382_INNERCYCLEBEGINTIME, R383_INNERCYCLEENDTIME, R384_PRODUCTID, R385_OFFERINGID, R386_OFFERINGINSTID, R387_ORDERSTATUS, R388_PRORATEFLAG, R389_STARTTIMEOFBILLCYCLE, R390_CHARGEPARTYINDICATOR, R391_POSRENTMODE, R392_TRIGGERMODE, R393_EXECUTEFLAG, R394_PRODUCTCODE, R395_MAINBALANCEINFO, R396_CHGBALANCEINFO, R397_CHGFREEUNITINFO, R398_USERSTATE, R399_CALLINGVPNTOPGROUPNUMBER, R400_CALLINGVPNGROUPNUMBER, R401_GROUPPAYFLAG, R402_TAXINFO, R403_LEGACYOFFERCODE, R404_PURCHASESEQUENCE, R405_SUBSCRIBER_KEY, R406_ACCOUNT_KEY, R407_OWNER_CUST_CODE, R408_PREPAID_BALANCE, R409_POSTPAID_BALANCE, R410_PAY_ACCOUNT_KEY, R411_PAY_DEFAULT_ACCT_ID, R412_PAY_PREPAID_BALANCE, R413_PAY_POSTPAID_BALANCE, R414_PAY_PAYTYPE, R415_PAY_BILL_CYCLE_ID, R416_PAY_CUST_ID, R417_PAY_CUST_CODE, R418_CALLINGVPNSHORTNUMBER, R419_CALLINGNETWORKTYPE, R420_LOCALAREA, R421_BUNDLEPACKAGE, R422_ORIGINALRENTALFEE, R423_CUGTYPE, R424_DEBIT_FROM_PAY_PRE_ACCT, R425_DEBIT_FROM_PAY_POST_ACCT, R426_PACKAGESERVICETYPE, R427_BUUPCUMULATEID, R428_BUUPCUMULATEVALUE, R429_BUPCUMULATENAME)
        (SELECT TO_DATE(TO_CHAR(SYSDATE-1, 'MM/DD/YYYY'), 'MM/DD/YYYY'), FILE_NAME, R1_CDR_ID, R2_CDR_SUB_ID, R3_CDR_TYPE, R4_SPLIT_CDR_REASON, R5_CDR_BATCH_ID, R6_SRC_REC_LINE_NO, R7_SRC_CDR_ID, R8_SRC_CDR_NO, R9_STATUS, R10_RE_RATING_TIMES, R11_CREATE_DATE, R12_START_DATE, R13_END_DATE, R14_CUST_LOCAL_START_DATE, R15_CUST_LOCAL_END_DATE, R16_STD_EVT_TYPE_ID, R17_EVT_SOURCE_CATEGORY, R18_OBJ_TYPE, R19_OBJ_ID, R20_OWNER_CUST_ID, R21_DEFAULT_ACCT_ID, R22_PRI_IDENTITY, R23_BILL_CYCLE_ID, R24_SERVICE_CATEGORY, R25_USAGE_SERVICE_TYPE, R26_SESSION_ID, R27_RESULT_CODE, R28_RESULT_REASON, R29_BE_ID, R30_HOT_SEQ, R31_CP_ID, R32_RECIPIENT_NUMBER, R33_USAGE_MEASURE_ID, R34_ACTUAL_USAGE, R35_RATE_USAGE, R36_SERVICE_UNIT_TYPE, R37_USAGE_MEASURE_ID2, R38_ACTUAL_USAGE2, R39_RATE_USAGE2, R40_SERVICE_UNIT_TYPE2, R41_DEBIT_AMOUNT, R42_RESERVED, R43_DEBIT_FROM_PREPAID, R44_DEBIT_FROM_ADVANCE_PREPAID, R45_DEBIT_FROM_POSTPAID, R46_DEBIT_FROM_ADVNCE_POSTPAID, R47_DEBIT_FROM_CREDIT_POSTPAID, 
        R48_TOTAL_TAX, R49_FREE_UNIT_AMOUNT_OF_TIMES, R50_FREE_UNIT_AMT_OF_DURATION, R51_FREE_UNIT_AMOUNT_OF_FLUX, R52_ACCT_ID, R53_ACCT_BALANCE_ID, R54_BALANCE_TYPE, R55_CUR_BALANCE, R56_CHG_BALANCE, R57_CURRENCY_ID, R58_OPER_TYPE, R59_ACCT_ID, R60_ACCT_BALANCE_ID, R61_BALANCE_TYPE, R62_CUR_BALANCE, R63_CHG_BALANCE, R64_CURRENCY_ID, R65_OPER_TYPE, R66_ACCT_ID, R67_ACCT_BALANCE_ID, R68_BALANCE_TYPE, R69_CUR_BALANCE, R70_CHG_BALANCE, R71_CURRENCY_ID, R72_OPER_TYPE, R73_ACCT_ID, R74_ACCT_BALANCE_ID, R75_BALANCE_TYPE, R76_CUR_BALANCE, R77_CHG_BALANCE, R78_CURRENCY_ID, R79_OPER_TYPE, R80_ACCT_ID, R81_ACCT_BALANCE_ID, R82_BALANCE_TYPE, R83_CUR_BALANCE, R84_CHG_BALANCE, R85_CURRENCY_ID, R86_OPER_TYPE, R87_ACCT_ID, R88_ACCT_BALANCE_ID, R89_BALANCE_TYPE, R90_CUR_BALANCE, R91_CHG_BALANCE, R92_CURRENCY_ID, R93_OPER_TYPE, R94_ACCT_ID, R95_ACCT_BALANCE_ID, R96_BALANCE_TYPE, R97_CUR_BALANCE, R98_CHG_BALANCE, R99_CURRENCY_ID, R100_OPER_TYPE, R101_ACCT_ID, 
        R102_ACCT_BALANCE_ID, R103_BALANCE_TYPE, R104_CUR_BALANCE, R105_CHG_BALANCE, R106_CURRENCY_ID, R107_OPER_TYPE, R108_ACCT_ID, R109_ACCT_BALANCE_ID, R110_BALANCE_TYPE, R111_CUR_BALANCE, R112_CHG_BALANCE, R113_CURRENCY_ID, R114_OPER_TYPE, R115_ACCT_ID, R116_ACCT_BALANCE_ID, R117_BALANCE_TYPE, R118_CUR_BALANCE, R119_CHG_BALANCE, R120_CURRENCY_ID, R121_OPER_TYPE, R122_FU_OWN_TYPE, R123_FU_OWN_ID, R124_FREE_UNIT_ID, R125_FREE_UNIT_TYPE, R126_CUR_AMOUNT, R127_CHG_AMOUNT, R128_FU_MEASURE_ID, R129_OPER_TYPE, R130_FU_OWN_TYPE, R131_FU_OWN_ID, R132_FREE_UNIT_ID, R133_FREE_UNIT_TYPE, R134_CUR_AMOUNT, R135_CHG_AMOUNT, R136_FU_MEASURE_ID, R137_OPER_TYPE, R138_FU_OWN_TYPE, R139_FU_OWN_ID, R140_FREE_UNIT_ID, R141_FREE_UNIT_TYPE, R142_CUR_AMOUNT, R143_CHG_AMOUNT, R144_FU_MEASURE_ID, R145_OPER_TYPE, R146_FU_OWN_TYPE, R147_FU_OWN_ID, R148_FREE_UNIT_ID, R149_FREE_UNIT_TYPE, R150_CUR_AMOUNT, R151_CHG_AMOUNT, R152_FU_MEASURE_ID, R153_OPER_TYPE, R154_FU_OWN_TYPE, R155_FU_OWN_ID, R156_FREE_UNIT_ID, R157_FREE_UNIT_TYPE, R158_CUR_AMOUNT, R159_CHG_AMOUNT, R160_FU_MEASURE_ID, R161_OPER_TYPE, R162_FU_OWN_TYPE, R163_FU_OWN_ID, R164_FREE_UNIT_ID, R165_FREE_UNIT_TYPE, R166_CUR_AMOUNT, 
        R167_CHG_AMOUNT, R168_FU_MEASURE_ID, R169_OPER_TYPE, R170_FU_OWN_TYPE, R171_FU_OWN_ID, R172_FREE_UNIT_ID, R173_FREE_UNIT_TYPE, R174_CUR_AMOUNT, R175_CHG_AMOUNT, R176_FU_MEASURE_ID, R177_OPER_TYPE, R178_FU_OWN_TYPE, R179_FU_OWN_ID, R180_FREE_UNIT_ID, R181_FREE_UNIT_TYPE, R182_CUR_AMOUNT, R183_CHG_AMOUNT, R184_FU_MEASURE_ID, R185_OPER_TYPE, R186_FU_OWN_TYPE, R187_FU_OWN_ID, R188_FREE_UNIT_ID, R189_FREE_UNIT_TYPE, R190_CUR_AMOUNT, R191_CHG_AMOUNT, R192_FU_MEASURE_ID, R193_OPER_TYPE, R194_FU_OWN_TYPE, R195_FU_OWN_ID, R196_FREE_UNIT_ID, R197_FREE_UNIT_TYPE, R198_CUR_AMOUNT, R199_CHG_AMOUNT, R200_FU_MEASURE_ID, R201_OPER_TYPE, R202_ACCT_ID, R203_ACCT_BALANCE_ID, R204_BALANCE_TYPE, R205_BONUS_AMOUNT, R206_CUR_BALANCE, R207_CURRENCY_ID, R208_OPER_TYPE, R209_CUR_EXPIRE_TIME, R210_ACCT_ID, R211_ACCT_BALANCE_ID, R212_BALANCE_TYPE, R213_CUR_BALANCE, R214_CHG_BALANCE, R215_CURRENCY_ID, R216_OPER_TYPE, R217_CUR_EXPIRE_TIME, R218_ACCT_ID, R219_ACCT_BALANCE_ID, R220_BALANCE_TYPE, R221_CUR_BALANCE, R222_CHG_BALANCE, R223_CURRENCY_ID, R224_OPER_TYPE, R225_CUR_EXPIRE_TIME, R226_ACCT_ID, R227_ACCT_BALANCE_ID, R228_BALANCE_TYPE, R229_BONUS_AMOUNT, R230_CUR_BALANCE, R231_CURRENCY_ID, R232_OPER_TYPE, R233_CUR_EXPIRE_TIME, R234_ACCT_ID, R235_ACCT_BALANCE_ID, 
        R236_BALANCE_TYPE, R237_BONUS_AMOUNT, R238_CUR_BALANCE, R239_CURRENCY_ID, R240_OPER_TYPE, R241_CUR_EXPIRE_TIME, R242_ACCT_ID, R243_ACCT_BALANCE_ID, R244_BALANCE_TYPE, R245_BONUS_AMOUNT, R246_CUR_BALANCE, R247_CURRENCY_ID, R248_OPER_TYPE, R249_CUR_EXPIRE_TIME, R250_ACCT_ID, R251_ACCT_BALANCE_ID, R252_BALANCE_TYPE, R253_BONUS_AMOUNT, R254_CUR_BALANCE, R255_CURRENCY_ID, R256_OPER_TYPE, R257_CUR_EXPIRE_TIME, R258_ACCT_ID, R259_ACCT_BALANCE_ID, R260_BALANCE_TYPE, R261_BONUS_AMOUNT, R262_CUR_BALANCE, R263_CURRENCY_ID, R264_OPER_TYPE, R265_CUR_EXPIRE_TIME, R266_ACCT_ID, R267_ACCT_BALANCE_ID, R268_BALANCE_TYPE, R269_BONUS_AMOUNT, R270_CUR_BALANCE, R271_CURRENCY_ID, R272_OPER_TYPE, R273_CUR_EXPIRE_TIME, R274_ACCT_ID, R275_ACCT_BALANCE_ID, R276_BALANCE_TYPE, R277_BONUS_AMOUNT, R278_CUR_BALANCE, R279_CURRENCY_ID, R280_OPER_TYPE, R281_CUR_EXPIRE_TIME, R282_FU_OWN_TYPE, R283_FU_OWN_ID, R284_FREE_UNIT_TYPE, R285_FREE_UNIT_ID, R286_BONUS_AMOUNT, R287_CURRENT_AMOUNT, R288_FU_MEASURE_ID, R289_OPER_TYPE, R290_CUR_EXPIRE_TIME, R291_FU_OWN_TYPE, R292_FU_OWN_ID, R293_FREE_UNIT_TYPE, R294_FREE_UNIT_ID, R295_BONUS_AMOUNT, R296_CURRENT_AMOUNT, R297_FU_MEASURE_ID, R298_OPER_TYPE, R299_CUR_EXPIRE_TIME, R300_FU_OWN_TYPE, R301_FU_OWN_ID, 
        R302_FREE_UNIT_TYPE, R303_FREE_UNIT_ID, R304_BONUS_AMOUNT, R305_CURRENT_AMOUNT, R306_FU_MEASURE_ID, R307_OPER_TYPE, R308_CUR_EXPIRE_TIME, R309_FU_OWN_TYPE, R310_FU_OWN_ID, R311_FREE_UNIT_TYPE, R312_FREE_UNIT_ID, R313_BONUS_AMOUNT, R314_CURRENT_AMOUNT, R315_FU_MEASURE_ID, R316_OPER_TYPE, R317_CURRENT_AMOUNT, R318_FU_OWN_TYPE, R319_FU_OWN_ID, R320_FREE_UNIT_TYPE, R321_FREE_UNIT_ID, R322_BONUS_AMOUNT, R323_CURRENT_AMOUNT, R324_FU_MEASURE_ID, R325_OPER_TYPE, R326_CUR_EXPIRE_TIME, R327_FU_OWN_TYPE, R328_FU_OWN_ID, R329_FREE_UNIT_TYPE, R330_FREE_UNIT_ID, R331_BONUS_AMOUNT, R332_CURRENT_AMOUNT, R333_FU_MEASURE_ID, R334_OPER_TYPE, R335_CUR_EXPIRE_TIME, R336_FU_OWN_TYPE, R337_FU_OWN_ID, R338_FREE_UNIT_TYPE, R339_FREE_UNIT_ID, R340_BONUS_AMOUNT, R341_CURRENT_AMOUNT, R342_FU_MEASURE_ID, R343_OPER_TYPE, R344_CUR_EXPIRE_TIME, R345_FU_OWN_TYPE, R346_FU_OWN_ID, R347_FREE_UNIT_TYPE, R348_FREE_UNIT_ID, R349_BONUS_AMOUNT, R350_CURRENT_AMOUNT, R351_FU_MEASURE_ID, R352_OPER_TYPE, R353_CUR_EXPIRE_TIME, R354_FU_OWN_TYPE, R355_FU_OWN_ID, R356_FREE_UNIT_TYPE, R357_FREE_UNIT_ID, R358_BONUS_AMOUNT, R359_CURRENT_AMOUNT, R360_FU_MEASURE_ID, R361_OPER_TYPE, R362_CUR_EXPIRE_TIME, R363_FU_OWN_TYPE, R364_FU_OWN_ID, R365_FREE_UNIT_TYPE,
        R366_FREE_UNIT_ID, R367_BONUS_AMOUNT, R368_CURRENT_AMOUNT, R369_FU_MEASURE_ID, R370_OPER_TYPE, R371_CUR_EXPIRE_TIME, R372_BRANDID, R373_MAINOFFERINGID, R374_PAYTYPE, R375_CHARGINGPARTYNUMBER, R376_CHARGINGPARTYTYPE, R377_CYCLEBEGINTIME,
        R378_CYCLEENDTIME, R379_CYCLETYPE, R380_CYCLELENGTH, R381_ELAPSECYCLES, R382_INNERCYCLEBEGINTIME, R383_INNERCYCLEENDTIME, R384_PRODUCTID, R385_OFFERINGID, R386_OFFERINGINSTID, R387_ORDERSTATUS, R388_PRORATEFLAG, R389_STARTTIMEOFBILLCYCLE, R390_CHARGEPARTYINDICATOR, R391_POSRENTMODE, R392_TRIGGERMODE, R393_EXECUTEFLAG, R394_PRODUCTCODE, R395_MAINBALANCEINFO, R396_CHGBALANCEINFO, R397_CHGFREEUNITINFO, R398_USERSTATE, R399_CALLINGVPNTOPGROUPNUMBER, R400_CALLINGVPNGROUPNUMBER, R401_GROUPPAYFLAG, R402_TAXINFO, R403_LEGACYOFFERCODE, R404_PURCHASESEQUENCE, R405_SUBSCRIBER_KEY, R406_ACCOUNT_KEY, R407_OWNER_CUST_CODE, R408_PREPAID_BALANCE, R409_POSTPAID_BALANCE, R410_PAY_ACCOUNT_KEY, R411_PAY_DEFAULT_ACCT_ID, R412_PAY_PREPAID_BALANCE, R413_PAY_POSTPAID_BALANCE, R414_PAY_PAYTYPE, R415_PAY_BILL_CYCLE_ID, R416_PAY_CUST_ID, R417_PAY_CUST_CODE, R418_CALLINGVPNSHORTNUMBER, R419_CALLINGNETWORKTYPE, R420_LOCALAREA, R421_BUNDLEPACKAGE, R422_ORIGINALRENTALFEE, R423_CUGTYPE, R424_DEBIT_FROM_PAY_PRE_ACCT, R425_DEBIT_FROM_PAY_POST_ACCT, R426_PACKAGESERVICETYPE, R427_BUUPCUMULATEID, R428_BUUPCUMULATEVALUE, R429_BUPCUMULATENAME FROM L1_RECURRING_TEMP_FULL);
        COMMIT;
    UPDATE ETL_LOG SET STATUS = 96,
    UPDATE_TIME=SYSDATE 
    WHERE DATE_KEY = VDATE_KEY
    AND LAYER = 'L2_RECURRING_TEMP_FULL';        
        COMMIT;
  ELSE
        INSERT INTO ETL_LOG (LAYER, DATE_KEY, SOURCE, STATUS, FILE_COUNT, PER_COUNT, POST_COUNT, INSERT_TIME)
        VALUES              ('L2_RECURRING_TEMP_FULL',VDATE_KEY,'mon','34',VCOUNT,'','',SYSDATE);
    COMMIT;
  END IF;
EXCEPTION
 WHEN OTHERS THEN NULL;
END;
/

