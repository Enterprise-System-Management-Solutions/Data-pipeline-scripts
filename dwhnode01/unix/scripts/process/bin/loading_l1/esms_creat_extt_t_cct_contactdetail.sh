PATH=$PATH:$HOME/.local/bin:$HOME/bin

export PATH

export TMP=/tmp
export TMPDIR=$TMP

export ORACLE_HOSTNAME=dwhnode01
export ORACLE_UNQNAME=dwhdb01
export ORACLE_BASE=/data01/app/oracle
export ORACLE_HOME=$ORACLE_BASE/product/19.0.0/dbhome_1
export ORA_INVENTORY=/data01/app/oraInventory
export ORACLE_SID=dwhdb01
export DATA_DIR=/data01/oradata

export PATH=/usr/sbin:/usr/local/bin:$PATH
export PATH=$ORACLE_HOME/bin:$PATH

export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib



FILE_NAME="CCT_CONTACTDETAIL_EXT"  export FILE_NAME

##echo "-------------------------------- $1 --------------------------------"
echo "Create table started at `date \"+%D %T\"`"

SYN_TYPE="cct_contactdetail" export SYN_TYPE
echo $SYN_TYPE

sqlplus -s <<EOF
dwh_user/dwh_user_123
set feedback off
drop table $FILE_NAME
/
create table $FILE_NAME
(
  SERIALNO            VARCHAR2(30 BYTE),
  CONTACTID           VARCHAR2(30 BYTE),
  CONTACTCHANNELID    VARCHAR2(20 BYTE),
  CONTACTCHANNELNAME  VARCHAR2(200 BYTE),
  CONTACTMODEID       VARCHAR2(20 BYTE),
  CONTACTMODENAME     VARCHAR2(200 BYTE),
  SUBCCNO             VARCHAR2(20 BYTE),
  VDNID               VARCHAR2(20 BYTE),
  HOSTEDCCID          VARCHAR2(30 BYTE),
  CALLID              VARCHAR2(30 BYTE),
  CALLTYPE            CHAR(1 BYTE),
  LANGUAGETYPEID      VARCHAR2(10 BYTE),
  LANGUAGETYPENAME    VARCHAR2(50 BYTE),
  CALLSKILLID         VARCHAR2(20 BYTE),
  CALLSKILLDESC       VARCHAR2(200 BYTE),
  CALLERNO            VARCHAR2(200 BYTE),
  CALLEDNO            VARCHAR2(200 BYTE),
  SUBSNUMBER          VARCHAR2(200 BYTE),
  ORGCALLERNO         VARCHAR2(200 BYTE),
  ORGCALLEDNO         VARCHAR2(200 BYTE),
  MEDIATYPEID         VARCHAR2(30 BYTE),
  MEDIATYPENAME       VARCHAR2(50 BYTE),
  CALLSTARTTIME       varchar2(36),
  CALLDURATION        varchar2(10),
  STAFFID             VARCHAR2(20 BYTE),
  CUSTCITYID          VARCHAR2(20 BYTE),
  SERVICECITYID       VARCHAR2(20 BYTE),
  STAFFCITYID         VARCHAR2(20 BYTE),
  SUBSCITYID          VARCHAR2(20 BYTE),
  SUBSNAME            VARCHAR2(200 BYTE),
  SUBSLEVELID         VARCHAR2(20 BYTE),
  SUBSLEVELNAME       VARCHAR2(200 BYTE),
  SUBSBRANDID         VARCHAR2(20 BYTE),
  SUBSBRANDNAME       VARCHAR2(200 BYTE),
  SUBSPHONE1          VARCHAR2(100 BYTE),
  SUBSPHONE2          VARCHAR2(100 BYTE),
  SUBSFAXNO           VARCHAR2(100 BYTE),
  SUBSEMAIL           VARCHAR2(60 BYTE),
  SUBSADDRESS         VARCHAR2(500 BYTE),
  CUSTID              VARCHAR2(50 BYTE),
  CUSTNAME            VARCHAR2(200 BYTE),
  CUSTLEVELID         VARCHAR2(20 BYTE),
  CUSTLEVELNAME       VARCHAR2(200 BYTE),
  CUSTBRANDID         VARCHAR2(20 BYTE),
  CUSTBRANDNAME       VARCHAR2(200 BYTE),
  CUSTPHONE1          VARCHAR2(100 BYTE),
  CUSTPHONE2          VARCHAR2(100 BYTE),
  CUSTFAXNO           VARCHAR2(100 BYTE),
  CUSTEMAIL           VARCHAR2(60 BYTE),
  CUSTADDRESS         VARCHAR2(500 BYTE),
  LINKMODE            VARCHAR2(20 BYTE),
  LINKMAN             VARCHAR2(100 BYTE),
  LINKINFO            VARCHAR2(100 BYTE),
  LINKADDRESS         VARCHAR2(500 BYTE),
  REMARK              VARCHAR2(2000 BYTE),
  CONTACTSTARTTIME    varchar2(36),
  CONTACTDURATION     varchar2(10),
  PLAYRECORDFLAG      CHAR(1 BYTE)       ,
  QCFLAG              CHAR(1 BYTE)       ,
  EVTERID             VARCHAR2(200 BYTE),
  HAVESERVICEFLAG     CHAR(1 BYTE)       ,
  INTERCEPTFLAG       CHAR(1 BYTE)       ,
  STAFFHANGUP         CHAR(1 BYTE),
  SURVEYTYPEID        VARCHAR2(20 BYTE),
  USERSATISFY         VARCHAR2(2 BYTE),
  SATISFYFILEPATH     VARCHAR2(200 BYTE),
  LISTENFLAG          VARCHAR2(4 BYTE)   ,
  INNERHELPFLAG       CHAR(1 BYTE)       ,
  PICKUPSTAFFID       VARCHAR2(20 BYTE),
  MAINCONTACTFLAG     CHAR(1 BYTE)       ,
  CALLTRACK           VARCHAR2(50 BYTE),
  DIGITCODE           VARCHAR2(50 BYTE),
  EXPFLAG             CHAR(1 BYTE)       ,
  HASRECORDFILE       CHAR(1 BYTE)       ,
  ISPROCESSED         CHAR(1 BYTE)       ,
  TENANTID            VARCHAR2(9 BYTE),
  DYFIELD1            VARCHAR2(3000 BYTE),
  DYFIELD2            VARCHAR2(2000 BYTE),
  DYFIELD3            VARCHAR2(1000 BYTE),
  DYFIELD4            VARCHAR2(1000 BYTE),
  DYFIELD5            VARCHAR2(1000 BYTE),
  DYFIELD6            VARCHAR2(1000 BYTE),
  DYFIELD7            VARCHAR2(1000 BYTE),
  DYFIELD8            VARCHAR2(1000 BYTE),
  DYFIELD9            VARCHAR2(1000 BYTE),
  DYFIELD10           VARCHAR2(1000 BYTE),
  DYFIELD11           VARCHAR2(1000 BYTE),
  DYFIELD12           VARCHAR2(1000 BYTE),
  DYFIELD13           VARCHAR2(1000 BYTE),
  DYFIELD14           VARCHAR2(1000 BYTE),
  DYFIELD15           VARCHAR2(1000 BYTE),
  DYFIELD16           VARCHAR2(1000 BYTE),
  DYFIELD17           VARCHAR2(1000 BYTE),
  DYFIELD18           VARCHAR2(1000 BYTE),
  DYFIELD19           VARCHAR2(1000 BYTE),
  DYFIELD20           VARCHAR2(1000 BYTE) 
)
ORGANIZATION EXTERNAL
  (  TYPE ORACLE_LOADER
     DEFAULT DIRECTORY CRM_IPCC_DIR 
        ACCESS PARAMETERS
       ( RECORDS DELIMITED by NEWLINE
        CHARACTERSET UTF8
	PREPROCESSOR execdir:'cat'
	BADFILE     '$1.bad'
        DISCARDFILE '$1.dis'
        FIELDS TERMINATED BY '|'
 )
     LOCATION (CRM_IPCC_DIR:'$1.unl')
  )
REJECT LIMIT UNLIMITED
NOPARALLEL
NOMONITORING
/
drop synonym  $SYN_TYPE
/
create synonym  $SYN_TYPE for $FILE_NAME
/
exit
EOF

echo "External table created"
