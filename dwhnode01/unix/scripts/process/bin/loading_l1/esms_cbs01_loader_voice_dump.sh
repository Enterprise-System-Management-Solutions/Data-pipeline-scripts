
PATH=$PATH:$HOME/.local/bin:$HOME/bin

export PATH

export TMP=/tmp
export TMPDIR=$TMP

export ORACLE_HOSTNAME=dwhnode01
export ORACLE_UNQNAME=dwhdb01
export ORACLE_BASE=/data01/app/oracle
export ORACLE_HOME=$ORACLE_BASE/product/19.0.0/dbhome_1
export ORA_INVENTORY=/data01/app/oraInventory
export ORACLE_SID=dwhdb01
export DATA_DIR=/data01/oradata

export PATH=/usr/sbin:/usr/local/bin:$PATH
export PATH=$ORACLE_HOME/bin:$PATH

export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib


# This function changes the status of files where errors where encountered to 34
updateOnError()
{
sqlplus  -s <<EOF
dwh_user/dwh_user_123
SET echo off
SET head off
SET feedback off
REM "WHENEVER SQLERROR EXIT SQL.SQLCODE"
UPDATE cdr_head_merge_dump
   SET process_status=34
 WHERE file_name='$1'
   AND process_status=30
/
COMMIT
/
EXIT
EOF
}

# This function lists files (SMSC) after mediation and status is =30

get_smsc_files()
{

sqlplus  -s <<EOF
dwh_user/dwh_user_123
SET head off
SET feedback off
SET pagesize 0
SET verify off
SET linesize 400
SELECT '/data02/cbs_cdrs/voice/dump_dir/'||','||'/data02/cbs_cdrs/voice/dump_dir/'||file_name||','||file_name||','||file_id
  FROM cdr_head_merge_dump
 WHERE source='voice'-- and trunc(PROCESS_DATE) = TRUNC(SYSDATE) 
   AND process_status=30
--   and mod  (FILE_ID,3) = 1 
   and rownum < 100
/
EOF
}


createSMSCUpdate()
{
sqlplus  -s <<EOF
dwh_user/dwh_user_123
SET echo on
SET head off
SET feedback off
WHENEVER SQLERROR EXIT SQL.SQLCODE

UPDATE cdr_head_merge_dump
   SET process_status=32
 WHERE source='voice'
   AND file_name='$1'
/
COMMIT
/
EXIT
EOF
}

insertSMSCUpdate()
{
sqlplus  -s <<EOF
dwh_user/dwh_user_123
SET echo on
SET head off
SET feedback off
WHENEVER SQLERROR EXIT SQL.SQLCODE
INSERT INTO L1_VOICE_dump (PROCESSED_DATE, FILE_NAME, V1_CDR_ID, V2_CDR_SUB_ID, V3_CDR_TYPE, V4_SPLIT_CDR_REASON, V5_CDR_BATCH_ID, V6_SRC_REC_LINE_NO, V7_SRC_CDR_ID, V8_SRC_CDR_NO, V9_STATUS, V10_RE_RATING_TIMES, V11_CREATE_DATE, V12_START_DATE, V13_END_DATE, V14_CUST_LOCAL_START_DATE, V15_CUST_LOCAL_END_DATE, V16_STD_EVT_TYPE_ID, V17_EVT_SOURCE_CATEGORY, V18_OBJ_TYPE, V19_OBJ_ID, V20_OWNER_CUST_ID, V21_DEFAULT_ACCT_ID, V22_PRI_IDENTITY, V23_BILL_CYCLE_ID, V24_SERVICE_CATEGORY, V25_USAGE_SERVICE_TYPE, V26_SESSION_ID, V27_RESULT_CODE, V28_RESULT_REASON, V29_BE_ID, V30_HOT_SEQ, V31_CP_ID, V32_RECIPIENT_NUMBER, V33_USAGE_MEASURE_ID, V34_ACTUAL_USAGE, V35_RATE_USAGE, V36_SERVICE_UNIT_TYPE, V37_USAGE_MEASURE_ID2, V38_ACTUAL_USAGE2, V39_RATE_USAGE2, V40_SERVICE_UNIT_TYPE2, V41_DEBIT_AMOUNT, V42_RESERVED, V43_DEBIT_FROM_PREPAID, V44_DEBIT_FROM_ADVANCE_PRE, V45_DEBIT_FROM_POSTPAID, V46_DEBIT_FROM_ADVANCE_POST, V47_DEBIT_FROM_CREDIT_POST, V48_TOTAL_TAX, V49_PAY_FREE_UNIT_TIMES, V50_PAY_FREE_UNIT_DURATION,
 V51_FREE_UNIT_AMOUNT_OF_FLUX, V52_ACCT_ID, V53_ACCT_BALANCE_ID, V54_BALANCE_TYPE, V55_CUR_BALANCE, V56_CHG_BALANCE, V57_CURRENCY_ID, V58_OPER_TYPE, V59_ACCT_ID, V60_ACCT_BALANCE_ID, V61_BALANCE_TYPE, V62_CUR_BALANCE, V63_CHG_BALANCE, V64_CURRENCY_ID, V65_OPER_TYPE, V66_ACCT_ID, V67_ACCT_BALANCE_ID, V68_BALANCE_TYPE, V69_CUR_BALANCE, V70_CHG_BALANCE, V71_CURRENCY_ID, V72_OPER_TYPE, V73_ACCT_ID, V74_ACCT_BALANCE_ID, V75_BALANCE_TYPE, V76_CUR_BALANCE, V77_CHG_BALANCE, V78_CURRENCY_ID, V79_OPER_TYPE, V80_ACCT_ID, V81_ACCT_BALANCE_ID, V82_BALANCE_TYPE, V83_CUR_BALANCE, V84_CHG_BALANCE, V85_CURRENCY_ID, V86_OPER_TYPE, V87_ACCT_ID, V88_ACCT_BALANCE_ID, V89_BALANCE_TYPE, V90_CUR_BALANCE, V91_CHG_BALANCE, V92_CURRENCY_ID, V93_OPER_TYPE, V94_ACCT_ID, V95_ACCT_BALANCE_ID, V96_BALANCE_TYPE, V97_CUR_BALANCE, V98_CHG_BALANCE, V99_CURRENCY_ID, V100_OPER_TYPE, 
 V101_ACCT_ID, V102_ACCT_BALANCE_ID, V103_BALANCE_TYPE, V104_CUR_BALANCE, V105_CHG_BALANCE, V106_CURRENCY_ID, V107_OPER_TYPE, V108_ACCT_ID, V109_ACCT_BALANCE_ID, V110_BALANCE_TYPE, V111_CUR_BALANCE, V112_CHG_BALANCE, V113_CURRENCY_ID, V114_OPER_TYPE, V115_ACCT_ID, V116_ACCT_BALANCE_ID, V117_BALANCE_TYPE, V118_CUR_BALANCE, V119_CHG_BALANCE, V120_CURRENCY_ID, V121_OPER_TYPE, V122_FU_OWN_TYPE, V123_FU_OWN_ID, V124_FREE_UNIT_ID, V125_FREE_UNIT_TYPE, V126_CUR_AMOUNT, V127_CHG_AMOUNT, V128_FU_MEASURE_ID, V129_OPER_TYPE, V130_FU_OWN_TYPE, V131_FU_OWN_ID, V132_FREE_UNIT_ID, V133_FREE_UNIT_TYPE, V134_CUR_AMOUNT, V135_CHG_AMOUNT, V136_FU_MEASURE_ID, V137_OPER_TYPE, V138_FU_OWN_TYPE, V139_FU_OWN_ID, V140_FREE_UNIT_ID, V141_FREE_UNIT_TYPE, V142_CUR_AMOUNT, V143_CHG_AMOUNT, V144_FU_MEASURE_ID, V145_OPER_TYPE, V146_FU_OWN_TYPE, V147_FU_OWN_ID, V148_FREE_UNIT_ID, V149_FREE_UNIT_TYPE, V150_CUR_AMOUNT, 
 V151_CHG_AMOUNT, V152_FU_MEASURE_ID, V153_OPER_TYPE, V154_FU_OWN_TYPE, V155_FU_OWN_ID, V156_FREE_UNIT_ID, V157_FREE_UNIT_TYPE, V158_CUR_AMOUNT, V159_CHG_AMOUNT, V160_FU_MEASURE_ID, V161_OPER_TYPE, V162_FU_OWN_TYPE, V163_FU_OWN_ID, V164_FREE_UNIT_ID, V165_FREE_UNIT_TYPE, V166_CUR_AMOUNT, V167_CHG_AMOUNT, V168_FU_MEASURE_ID, V169_OPER_TYPE, V170_FU_OWN_TYPE, V171_FU_OWN_ID, V172_FREE_UNIT_ID, V173_FREE_UNIT_TYPE, V174_CUR_AMOUNT, V175_CHG_AMOUNT, V176_FU_MEASURE_ID, V177_OPER_TYPE, V178_FU_OWN_TYPE, V179_FU_OWN_ID, V180_FREE_UNIT_ID, V181_FREE_UNIT_TYPE, V182_CUR_AMOUNT, V183_CHG_AMOUNT, V184_FU_MEASURE_ID, V185_OPER_TYPE, V186_FU_OWN_TYPE, V187_FU_OWN_ID, V188_FREE_UNIT_ID, V189_FREE_UNIT_TYPE, V190_CUR_AMOUNT, V191_CHG_AMOUNT, V192_FU_MEASURE_ID, V193_OPER_TYPE, V194_FU_OWN_TYPE, V195_FU_OWN_ID, V196_FREE_UNIT_ID, V197_FREE_UNIT_TYPE, V198_CUR_AMOUNT, V199_CHG_AMOUNT, V200_FU_MEASURE_ID, 
 V201_OPER_TYPE, V202_ACCT_ID, V203_ACCT_BALANCE_ID, V204_BALANCE_TYPE, V205_BONUS_AMOUNT, V206_CUR_BALANCE, V207_CURRENCY_ID, V208_OPER_TYPE, V209_CUR_EXPIRE_TIME, V210_ACCT_ID, V211_ACCT_BALANCE_ID, V212_BALANCE_TYPE, V213_CUR_BALANCE, V214_CHG_BALANCE, V215_CURRENCY_ID, V216_OPER_TYPE, V217_CUR_EXPIRE_TIME, V218_ACCT_ID, V219_ACCT_BALANCE_ID, V220_BALANCE_TYPE, V221_CUR_BALANCE, V222_CHG_BALANCE, V223_CURRENCY_ID, V224_OPER_TYPE, V225_CUR_EXPIRE_TIME, V226_ACCT_ID, V227_ACCT_BALANCE_ID, V228_BALANCE_TYPE, V229_BONUS_AMOUNT, V230_CUR_BALANCE, V231_CURRENCY_ID, V232_OPER_TYPE, V233_CUR_EXPIRE_TIME, V234_ACCT_ID, V235_ACCT_BALANCE_ID, V236_BALANCE_TYPE, V237_BONUS_AMOUNT, V238_CUR_BALANCE, V239_CURRENCY_ID, V240_OPER_TYPE, V241_CUR_EXPIRE_TIME, V242_ACCT_ID, V243_ACCT_BALANCE_ID, V244_BALANCE_TYPE, V245_BONUS_AMOUNT, V246_CUR_BALANCE, V247_CURRENCY_ID, V248_OPER_TYPE, V249_CUR_EXPIRE_TIME, V250_ACCT_ID, 
 V251_ACCT_BALANCE_ID, V252_BALANCE_TYPE, V253_BONUS_AMOUNT, V254_CUR_BALANCE, V255_CURRENCY_ID, V256_OPER_TYPE, V257_CUR_EXPIRE_TIME, V258_ACCT_ID, V259_ACCT_BALANCE_ID, V260_BALANCE_TYPE, V261_BONUS_AMOUNT, V262_CUR_BALANCE, V263_CURRENCY_ID, V264_OPER_TYPE, V265_CUR_EXPIRE_TIME, V266_ACCT_ID, V267_ACCT_BALANCE_ID, V268_BALANCE_TYPE, V269_BONUS_AMOUNT, V270_CUR_BALANCE, V271_CURRENCY_ID, V272_OPER_TYPE, V273_CUR_EXPIRE_TIME, V274_ACCT_ID, V275_ACCT_BALANCE_ID, V276_BALANCE_TYPE, V277_BONUS_AMOUNT, V278_CUR_BALANCE, V279_CURRENCY_ID, V280_OPER_TYPE, V281_CUR_EXPIRE_TIME, V282_FU_OWN_TYPE, V283_FU_OWN_ID, V284_FREE_UNIT_TYPE, V285_FREE_UNIT_ID, V286_BONUS_AMOUNT, V287_CURRENT_AMOUNT, V288_FU_MEASURE_ID, V289_OPER_TYPE, V290_CUR_EXPIRE_TIME, V291_FU_OWN_TYPE, V292_FU_OWN_ID, V293_FREE_UNIT_TYPE, V294_FREE_UNIT_ID, V295_BONUS_AMOUNT, V296_CURRENT_AMOUNT, V297_FU_MEASURE_ID, V298_OPER_TYPE, V299_CUR_EXPIRE_TIME, V300_FU_OWN_TYPE, 
 V301_FU_OWN_ID, V302_FREE_UNIT_TYPE, V303_FREE_UNIT_ID, V304_BONUS_AMOUNT, V305_CURRENT_AMOUNT, V306_FU_MEASURE_ID, V307_OPER_TYPE, V308_CUR_EXPIRE_TIME, V309_FU_OWN_TYPE, V310_FU_OWN_ID, V311_FREE_UNIT_TYPE, V312_FREE_UNIT_ID, V313_BONUS_AMOUNT, V314_CURRENT_AMOUNT, V315_FU_MEASURE_ID, V316_OPER_TYPE, V317_CURRENT_AMOUNT, V318_FU_OWN_TYPE, V319_FU_OWN_ID, V320_FREE_UNIT_TYPE, V321_FREE_UNIT_ID, V322_BONUS_AMOUNT, V323_CURRENT_AMOUNT, V324_FU_MEASURE_ID, V325_OPER_TYPE, V326_CUR_EXPIRE_TIME, V327_FU_OWN_TYPE, V328_FU_OWN_ID, V329_FREE_UNIT_TYPE, V330_FREE_UNIT_ID, V331_BONUS_AMOUNT, V332_CURRENT_AMOUNT, V333_FU_MEASURE_ID, V334_OPER_TYPE, V335_CUR_EXPIRE_TIME, V336_FU_OWN_TYPE, V337_FU_OWN_ID, V338_FREE_UNIT_TYPE, V339_FREE_UNIT_ID, V340_BONUS_AMOUNT, V341_CURRENT_AMOUNT, V342_FU_MEASURE_ID, V343_OPER_TYPE, V344_CUR_EXPIRE_TIME, V345_FU_OWN_TYPE, V346_FU_OWN_ID, V347_FREE_UNIT_TYPE, V348_FREE_UNIT_ID, V349_BONUS_AMOUNT, V350_CURRENT_AMOUNT, 
 V351_FU_MEASURE_ID, V352_OPER_TYPE, V353_CUR_EXPIRE_TIME, V354_FU_OWN_TYPE, V355_FU_OWN_ID, V356_FREE_UNIT_TYPE, V357_FREE_UNIT_ID, V358_BONUS_AMOUNT, V359_CURRENT_AMOUNT, V360_FU_MEASURE_ID, V361_OPER_TYPE, V362_CUR_EXPIRE_TIME, V363_FU_OWN_TYPE, V364_FU_OWN_ID, V365_FREE_UNIT_TYPE, V366_FREE_UNIT_ID, V367_BONUS_AMOUNT, V368_CURRENT_AMOUNT, V369_FU_MEASURE_ID, V370_OPER_TYPE, V371_CUR_EXPIRE_TIME, V372_CALLINGPARTYNUMBER, V373_CALLEDPARTYNUMBER, V374_CALLINGPARTYIMSI, V375_CALLEDPARTYIMSI, V376_DIALEDNUMBER, V377_ORIGINALCALLEDPARTY, V378_SERVICEFLOW, V379_CALLFORWARDINDICATOR, V380_CALLINGROAMINFO, V381_CALLINGCELLID, V382_CALLEDROAMINFO, V383_CALLEDCELLID, V384_TIMESTAMPOFSSP, V385_TIMEZONEOFSSP, V386_BEARERCAPABILITY, V387_CHARGINGTIME, V388_WAITDURATION, V389_TERMINATIONREASON, V390_CALLREFERENCENUMBER, V391_IMEI, V392_ACCESSPREFIX, V393_ROUTINGPREFIX, V394_REDIRECTINGPARTYID, V395_MSCADDRESS, V396_BRANDID, V397_MAINOFFERINGID, V398_CHARGINGPARTYNUMBER, V399_CHARGEPARTYINDICATOR, V400_PAYTYPE, 
 V401_CHARGINGTYPE, V402_CALLTYPE, V403_ROAMSTATE, V404_CALLINGHOMECOUNTRYCODE, V405_CALLINGHOMEAREANUMBER, V406_CALLINGHOMENETWORKCODE, V407_CALLINGROAMCOUNTRYCODE, V408_CALLINGROAMAREANUMBER, V409_CALLINGROAMNETWORKCODE, V410_CALLEDHOMECOUNTRYCODE, V411_CALLEDHOMEAREANUMBER, V412_CALLEDHOMENETWORKCODE, V413_CALLEDROAMCOUNTRYCODE, V414_CALLEDROAMAREANUMBER, V415_CALLEDROAMNETWORKCODE, V416_SERVICETYPE, V417_HOTLINEINDICATOR, V418_HOMEZONEID, V419_SPECIALZONEID, V420_NPFLAG, V421_NPPREFIX, V422_CALLINGCUGNO, V423_CALLEDCUGNO, V424_OPPOSENUMBERTYPE, V425_CALLINGNETWORKTYPE, V426_CALLEDNETWORKTYPE, V427_CALLINGVPNTOPGROUPNUMBER, V428_CALLINGVPNGROUPNUMBER, V429_CALLINGVPNSHORTNUMBER, V430_CALLEDVPNTOPGROUPNUMBER, V431_CALLEDVPNGROUPNUMBER, V432_CALLEDVPNSHORTNUMBER, V433_GROUPCALLTYPE, V434_ONLINECHARGINGFLAG, V435_STARTTIMEOFBILLCYCLE, V436_LASTEFFECTOFFERING, V437_DTDISCOUNT, V438_OPPOSEMAINOFFERINGID, V439_MAINBALANCEINFO, V440_CHGBALANCEINFO, V441_CHGFREEUNITINFO, V442_USERSTATE, V443_GROUPPAYFLAG, V444_ROAMINGZONEID, V445_PRIMARYOFFERCHGAMT, V446_ORIGINATINGIOI, V447_TERMINATINGIOI, V448_IMSCHARGINGIDENTIFIER, V449_RESERVED, V450_RECEPIENT_CP_ID,
 V451_TAXINFO, V452_VISTLOCALSTARTTIME, V453_VISTLOCALENDTIME, V454_SUBSCRIBER_KEY, V455_ACCOUNT_KEY, V456_SAMEBRANDFLAG, V457_PREPAID_BALANCE, V458_POSTPAID_BALANCE, V459_PAY_PAYTYPE, V460_PAY_BILL_CYCLE_ID, V461_PAY_FREE_UNIT_TIMES, V462_PAY_FREE_UNIT_DURATION, V463_PAY_DEBIT_AMOUNT, V464_PAY_DEBIT_FROM_PREPAID, V465_PAY_POSTPAID_BALANCE, V466_PAY_ACCOUNT_KEY, V467_PAY_PREPAID_BALANCE, V468_PAY_DEBIT_FROM_POSTPAID, V469_PAY_DEFAULT_ACCT_ID, V470_STARTCOUNTRYGROUP, V471_ENDCOUNTRYGROUP, V472_SUBSCRIBERIDTYPE, V473_DISCOUNTOFLASTEFFOFFERING, V474_ACCUMULATIONCHANGE, V475_ACCTBALCHGLIST, V476_ONNETINDICATOR, V477_TAPFILENAME, V478_PAY_SUB_ID, V479_PREFERAREACELLID, V480_EFFECTOFFERCODELIST, V481_SETUPFEE, V482_OVERDRAFTFLAG, V483_ACCUMLATEDPOINT)
(SELECT TO_DATE(TO_CHAR(sysdate, 'MM/DD/YYYY'), 'MM/DD/YYYY'), '$1',V1_CDR_ID, V2_CDR_SUB_ID, V3_CDR_TYPE, V4_SPLIT_CDR_REASON, V5_CDR_BATCH_ID, V6_SRC_REC_LINE_NO, V7_SRC_CDR_ID, V8_SRC_CDR_NO, V9_STATUS, V10_RE_RATING_TIMES, V11_CREATE_DATE, V12_START_DATE, V13_END_DATE, V14_CUST_LOCAL_START_DATE, V15_CUST_LOCAL_END_DATE, V16_STD_EVT_TYPE_ID, V17_EVT_SOURCE_CATEGORY, V18_OBJ_TYPE, V19_OBJ_ID, V20_OWNER_CUST_ID, V21_DEFAULT_ACCT_ID, V22_PRI_IDENTITY, V23_BILL_CYCLE_ID, V24_SERVICE_CATEGORY, V25_USAGE_SERVICE_TYPE, V26_SESSION_ID, V27_RESULT_CODE, V28_RESULT_REASON, V29_BE_ID, V30_HOT_SEQ, V31_CP_ID, V32_RECIPIENT_NUMBER, V33_USAGE_MEASURE_ID, V34_ACTUAL_USAGE, V35_RATE_USAGE, V36_SERVICE_UNIT_TYPE, V37_USAGE_MEASURE_ID2, V38_ACTUAL_USAGE2, V39_RATE_USAGE2, V40_SERVICE_UNIT_TYPE2, V41_DEBIT_AMOUNT, V42_RESERVED, V43_DEBIT_FROM_PREPAID, V44_DEBIT_FROM_ADVANCE_PRE, V45_DEBIT_FROM_POSTPAID, V46_DEBIT_FROM_ADVANCE_POST, V47_DEBIT_FROM_CREDIT_POST, V48_TOTAL_TAX, V49_PAY_FREE_UNIT_TIMES, V50_PAY_FREE_UNIT_DURATION,
 V51_FREE_UNIT_AMOUNT_OF_FLUX, V52_ACCT_ID, V53_ACCT_BALANCE_ID, V54_BALANCE_TYPE, V55_CUR_BALANCE, V56_CHG_BALANCE, V57_CURRENCY_ID, V58_OPER_TYPE, V59_ACCT_ID, V60_ACCT_BALANCE_ID, V61_BALANCE_TYPE, V62_CUR_BALANCE, V63_CHG_BALANCE, V64_CURRENCY_ID, V65_OPER_TYPE, V66_ACCT_ID, V67_ACCT_BALANCE_ID, V68_BALANCE_TYPE, V69_CUR_BALANCE, V70_CHG_BALANCE, V71_CURRENCY_ID, V72_OPER_TYPE, V73_ACCT_ID, V74_ACCT_BALANCE_ID, V75_BALANCE_TYPE, V76_CUR_BALANCE, V77_CHG_BALANCE, V78_CURRENCY_ID, V79_OPER_TYPE, V80_ACCT_ID, V81_ACCT_BALANCE_ID, V82_BALANCE_TYPE, V83_CUR_BALANCE, V84_CHG_BALANCE, V85_CURRENCY_ID, V86_OPER_TYPE, V87_ACCT_ID, V88_ACCT_BALANCE_ID, V89_BALANCE_TYPE, V90_CUR_BALANCE, V91_CHG_BALANCE, V92_CURRENCY_ID, V93_OPER_TYPE, V94_ACCT_ID, V95_ACCT_BALANCE_ID, V96_BALANCE_TYPE, V97_CUR_BALANCE, V98_CHG_BALANCE, V99_CURRENCY_ID, V100_OPER_TYPE, 
 V101_ACCT_ID, V102_ACCT_BALANCE_ID, V103_BALANCE_TYPE, V104_CUR_BALANCE, V105_CHG_BALANCE, V106_CURRENCY_ID, V107_OPER_TYPE, V108_ACCT_ID, V109_ACCT_BALANCE_ID, V110_BALANCE_TYPE, V111_CUR_BALANCE, V112_CHG_BALANCE, V113_CURRENCY_ID, V114_OPER_TYPE, V115_ACCT_ID, V116_ACCT_BALANCE_ID, V117_BALANCE_TYPE, V118_CUR_BALANCE, V119_CHG_BALANCE, V120_CURRENCY_ID, V121_OPER_TYPE, V122_FU_OWN_TYPE, V123_FU_OWN_ID, V124_FREE_UNIT_ID, V125_FREE_UNIT_TYPE, V126_CUR_AMOUNT, V127_CHG_AMOUNT, V128_FU_MEASURE_ID, V129_OPER_TYPE, V130_FU_OWN_TYPE, V131_FU_OWN_ID, V132_FREE_UNIT_ID, V133_FREE_UNIT_TYPE, V134_CUR_AMOUNT, V135_CHG_AMOUNT, V136_FU_MEASURE_ID, V137_OPER_TYPE, V138_FU_OWN_TYPE, V139_FU_OWN_ID, V140_FREE_UNIT_ID, V141_FREE_UNIT_TYPE, V142_CUR_AMOUNT, V143_CHG_AMOUNT, V144_FU_MEASURE_ID, V145_OPER_TYPE, V146_FU_OWN_TYPE, V147_FU_OWN_ID, V148_FREE_UNIT_ID, V149_FREE_UNIT_TYPE, V150_CUR_AMOUNT, 
 V151_CHG_AMOUNT, V152_FU_MEASURE_ID, V153_OPER_TYPE, V154_FU_OWN_TYPE, V155_FU_OWN_ID, V156_FREE_UNIT_ID, V157_FREE_UNIT_TYPE, V158_CUR_AMOUNT, V159_CHG_AMOUNT, V160_FU_MEASURE_ID, V161_OPER_TYPE, V162_FU_OWN_TYPE, V163_FU_OWN_ID, V164_FREE_UNIT_ID, V165_FREE_UNIT_TYPE, V166_CUR_AMOUNT, V167_CHG_AMOUNT, V168_FU_MEASURE_ID, V169_OPER_TYPE, V170_FU_OWN_TYPE, V171_FU_OWN_ID, V172_FREE_UNIT_ID, V173_FREE_UNIT_TYPE, V174_CUR_AMOUNT, V175_CHG_AMOUNT, V176_FU_MEASURE_ID, V177_OPER_TYPE, V178_FU_OWN_TYPE, V179_FU_OWN_ID, V180_FREE_UNIT_ID, V181_FREE_UNIT_TYPE, V182_CUR_AMOUNT, V183_CHG_AMOUNT, V184_FU_MEASURE_ID, V185_OPER_TYPE, V186_FU_OWN_TYPE, V187_FU_OWN_ID, V188_FREE_UNIT_ID, V189_FREE_UNIT_TYPE, V190_CUR_AMOUNT, V191_CHG_AMOUNT, V192_FU_MEASURE_ID, V193_OPER_TYPE, V194_FU_OWN_TYPE, V195_FU_OWN_ID, V196_FREE_UNIT_ID, V197_FREE_UNIT_TYPE, V198_CUR_AMOUNT, V199_CHG_AMOUNT, V200_FU_MEASURE_ID, 
 V201_OPER_TYPE, V202_ACCT_ID, V203_ACCT_BALANCE_ID, V204_BALANCE_TYPE, V205_BONUS_AMOUNT, V206_CUR_BALANCE, V207_CURRENCY_ID, V208_OPER_TYPE, V209_CUR_EXPIRE_TIME, V210_ACCT_ID, V211_ACCT_BALANCE_ID, V212_BALANCE_TYPE, V213_CUR_BALANCE, V214_CHG_BALANCE, V215_CURRENCY_ID, V216_OPER_TYPE, V217_CUR_EXPIRE_TIME, V218_ACCT_ID, V219_ACCT_BALANCE_ID, V220_BALANCE_TYPE, V221_CUR_BALANCE, V222_CHG_BALANCE, V223_CURRENCY_ID, V224_OPER_TYPE, V225_CUR_EXPIRE_TIME, V226_ACCT_ID, V227_ACCT_BALANCE_ID, V228_BALANCE_TYPE, V229_BONUS_AMOUNT, V230_CUR_BALANCE, V231_CURRENCY_ID, V232_OPER_TYPE, V233_CUR_EXPIRE_TIME, V234_ACCT_ID, V235_ACCT_BALANCE_ID, V236_BALANCE_TYPE, V237_BONUS_AMOUNT, V238_CUR_BALANCE, V239_CURRENCY_ID, V240_OPER_TYPE, V241_CUR_EXPIRE_TIME, V242_ACCT_ID, V243_ACCT_BALANCE_ID, V244_BALANCE_TYPE, V245_BONUS_AMOUNT, V246_CUR_BALANCE, V247_CURRENCY_ID, V248_OPER_TYPE, V249_CUR_EXPIRE_TIME, V250_ACCT_ID, 
 V251_ACCT_BALANCE_ID, V252_BALANCE_TYPE, V253_BONUS_AMOUNT, V254_CUR_BALANCE, V255_CURRENCY_ID, V256_OPER_TYPE, V257_CUR_EXPIRE_TIME, V258_ACCT_ID, V259_ACCT_BALANCE_ID, V260_BALANCE_TYPE, V261_BONUS_AMOUNT, V262_CUR_BALANCE, V263_CURRENCY_ID, V264_OPER_TYPE, V265_CUR_EXPIRE_TIME, V266_ACCT_ID, V267_ACCT_BALANCE_ID, V268_BALANCE_TYPE, V269_BONUS_AMOUNT, V270_CUR_BALANCE, V271_CURRENCY_ID, V272_OPER_TYPE, V273_CUR_EXPIRE_TIME, V274_ACCT_ID, V275_ACCT_BALANCE_ID, V276_BALANCE_TYPE, V277_BONUS_AMOUNT, V278_CUR_BALANCE, V279_CURRENCY_ID, V280_OPER_TYPE, V281_CUR_EXPIRE_TIME, V282_FU_OWN_TYPE, V283_FU_OWN_ID, V284_FREE_UNIT_TYPE, V285_FREE_UNIT_ID, V286_BONUS_AMOUNT, V287_CURRENT_AMOUNT, V288_FU_MEASURE_ID, V289_OPER_TYPE, V290_CUR_EXPIRE_TIME, V291_FU_OWN_TYPE, V292_FU_OWN_ID, V293_FREE_UNIT_TYPE, V294_FREE_UNIT_ID, V295_BONUS_AMOUNT, V296_CURRENT_AMOUNT, V297_FU_MEASURE_ID, V298_OPER_TYPE, V299_CUR_EXPIRE_TIME, V300_FU_OWN_TYPE, 
 V301_FU_OWN_ID, V302_FREE_UNIT_TYPE, V303_FREE_UNIT_ID, V304_BONUS_AMOUNT, V305_CURRENT_AMOUNT, V306_FU_MEASURE_ID, V307_OPER_TYPE, V308_CUR_EXPIRE_TIME, V309_FU_OWN_TYPE, V310_FU_OWN_ID, V311_FREE_UNIT_TYPE, V312_FREE_UNIT_ID, V313_BONUS_AMOUNT, V314_CURRENT_AMOUNT, V315_FU_MEASURE_ID, V316_OPER_TYPE, V317_CURRENT_AMOUNT, V318_FU_OWN_TYPE, V319_FU_OWN_ID, V320_FREE_UNIT_TYPE, V321_FREE_UNIT_ID, V322_BONUS_AMOUNT, V323_CURRENT_AMOUNT, V324_FU_MEASURE_ID, V325_OPER_TYPE, V326_CUR_EXPIRE_TIME, V327_FU_OWN_TYPE, V328_FU_OWN_ID, V329_FREE_UNIT_TYPE, V330_FREE_UNIT_ID, V331_BONUS_AMOUNT, V332_CURRENT_AMOUNT, V333_FU_MEASURE_ID, V334_OPER_TYPE, V335_CUR_EXPIRE_TIME, V336_FU_OWN_TYPE, V337_FU_OWN_ID, V338_FREE_UNIT_TYPE, V339_FREE_UNIT_ID, V340_BONUS_AMOUNT, V341_CURRENT_AMOUNT, V342_FU_MEASURE_ID, V343_OPER_TYPE, V344_CUR_EXPIRE_TIME, V345_FU_OWN_TYPE, V346_FU_OWN_ID, V347_FREE_UNIT_TYPE, V348_FREE_UNIT_ID, V349_BONUS_AMOUNT, V350_CURRENT_AMOUNT, 
 V351_FU_MEASURE_ID, V352_OPER_TYPE, V353_CUR_EXPIRE_TIME, V354_FU_OWN_TYPE, V355_FU_OWN_ID, V356_FREE_UNIT_TYPE, V357_FREE_UNIT_ID, V358_BONUS_AMOUNT, V359_CURRENT_AMOUNT, V360_FU_MEASURE_ID, V361_OPER_TYPE, V362_CUR_EXPIRE_TIME, V363_FU_OWN_TYPE, V364_FU_OWN_ID, V365_FREE_UNIT_TYPE, V366_FREE_UNIT_ID, V367_BONUS_AMOUNT, V368_CURRENT_AMOUNT, V369_FU_MEASURE_ID, V370_OPER_TYPE, V371_CUR_EXPIRE_TIME, V372_CALLINGPARTYNUMBER, V373_CALLEDPARTYNUMBER, V374_CALLINGPARTYIMSI, V375_CALLEDPARTYIMSI, V376_DIALEDNUMBER, V377_ORIGINALCALLEDPARTY, V378_SERVICEFLOW, V379_CALLFORWARDINDICATOR, V380_CALLINGROAMINFO, V381_CALLINGCELLID, V382_CALLEDROAMINFO, V383_CALLEDCELLID, V384_TIMESTAMPOFSSP, V385_TIMEZONEOFSSP, V386_BEARERCAPABILITY, V387_CHARGINGTIME, V388_WAITDURATION, V389_TERMINATIONREASON, V390_CALLREFERENCENUMBER, V391_IMEI, V392_ACCESSPREFIX, V393_ROUTINGPREFIX, V394_REDIRECTINGPARTYID, V395_MSCADDRESS, V396_BRANDID, V397_MAINOFFERINGID, V398_CHARGINGPARTYNUMBER, V399_CHARGEPARTYINDICATOR, V400_PAYTYPE, 
 V401_CHARGINGTYPE, V402_CALLTYPE, V403_ROAMSTATE, V404_CALLINGHOMECOUNTRYCODE, V405_CALLINGHOMEAREANUMBER, V406_CALLINGHOMENETWORKCODE, V407_CALLINGROAMCOUNTRYCODE, V408_CALLINGROAMAREANUMBER, V409_CALLINGROAMNETWORKCODE, V410_CALLEDHOMECOUNTRYCODE, V411_CALLEDHOMEAREANUMBER, V412_CALLEDHOMENETWORKCODE, V413_CALLEDROAMCOUNTRYCODE, V414_CALLEDROAMAREANUMBER, V415_CALLEDROAMNETWORKCODE, V416_SERVICETYPE, V417_HOTLINEINDICATOR, V418_HOMEZONEID, V419_SPECIALZONEID, V420_NPFLAG, V421_NPPREFIX, V422_CALLINGCUGNO, V423_CALLEDCUGNO, V424_OPPOSENUMBERTYPE, V425_CALLINGNETWORKTYPE, V426_CALLEDNETWORKTYPE, V427_CALLINGVPNTOPGROUPNUMBER, V428_CALLINGVPNGROUPNUMBER, V429_CALLINGVPNSHORTNUMBER, V430_CALLEDVPNTOPGROUPNUMBER, V431_CALLEDVPNGROUPNUMBER, V432_CALLEDVPNSHORTNUMBER, V433_GROUPCALLTYPE, V434_ONLINECHARGINGFLAG, V435_STARTTIMEOFBILLCYCLE, V436_LASTEFFECTOFFERING, V437_DTDISCOUNT, V438_OPPOSEMAINOFFERINGID, V439_MAINBALANCEINFO, V440_CHGBALANCEINFO, V441_CHGFREEUNITINFO, V442_USERSTATE, V443_GROUPPAYFLAG, V444_ROAMINGZONEID, V445_PRIMARYOFFERCHGAMT, V446_ORIGINATINGIOI, V447_TERMINATINGIOI, V448_IMSCHARGINGIDENTIFIER, V449_RESERVED, V450_RECEPIENT_CP_ID,
 V451_TAXINFO, V452_VISTLOCALSTARTTIME, V453_VISTLOCALENDTIME, V454_SUBSCRIBER_KEY, V455_ACCOUNT_KEY, V456_SAMEBRANDFLAG, V457_PREPAID_BALANCE, V458_POSTPAID_BALANCE, V459_PAY_PAYTYPE, V460_PAY_BILL_CYCLE_ID, V461_PAY_FREE_UNIT_TIMES, V462_PAY_FREE_UNIT_DURATION, V463_PAY_DEBIT_AMOUNT, V464_PAY_DEBIT_FROM_PREPAID, V465_PAY_POSTPAID_BALANCE, V466_PAY_ACCOUNT_KEY, V467_PAY_PREPAID_BALANCE, V468_PAY_DEBIT_FROM_POSTPAID, V469_PAY_DEFAULT_ACCT_ID, V470_STARTCOUNTRYGROUP, V471_ENDCOUNTRYGROUP, V472_SUBSCRIBERIDTYPE, V473_DISCOUNTOFLASTEFFOFFERING, V474_ACCUMULATIONCHANGE, V475_ACCTBALCHGLIST, V476_ONNETINDICATOR, V477_TAPFILENAME, V478_PAY_SUB_ID, V479_PREFERAREACELLID, V480_EFFECTOFFERCODELIST, V481_SETUPFEE, V482_OVERDRAFTFLAG, V483_ACCUMLATEDPOINT FROM VOICE01_dump_EXT )


/
COMMIT
/
UPDATE cdr_head_merge_dump
   SET process_status=96
 WHERE source='voice'
   AND file_name='$1'
/
COMMIT
/
EXIT
EOF
}

# ======= SMSC SECTION =====

lock=/data02/scripts/process/bin/voice01_dump_loader_lock  export lock

if [ -f $lock ] ; then
exit 2

else
touch $lock

fileList=`get_smsc_files`

for fil in $fileList
do

v3=`echo ${fil}|sed s/,/\ /g|awk '{print $3}'`   ### file name
v4=`echo ${fil}|sed s/,/\ /g|awk '{print $4}'`   ### file id

cd /data02/scripts/process/bin/loading_l1/
sh esms_create_cbs01_ext_voice_dump.sh $v3 
createSMSCUpdate $v3
insertSMSCUpdate $v3


# ~~~~~~~~~~~~~~~~~~~~~~~~
updateOnError $v3 $v4
#~~~~~~~~~~~~~~~~~~~~~~~~~

done

rm -f $lock

fi

